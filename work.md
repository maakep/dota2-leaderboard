# Dota 2 Leaderboard Time Machine - Implementation Plan

## Overview

Build a static web app that visualizes the Dota 2 Europe leaderboard changes over time, with an animated timeline, player detail views, and winner/loser highlights.

## Current State Analysis

### Data Structure

- **Source file**: `leaderboard/europe.json`
- **Update frequency**: ~hourly via GitHub Actions
- **History**: Git commits with timestamps in commit messages (e.g., "update Europe leaderboard data - 2026-01-16 11:31 UTC")
- **Data format**: Array of 500 player objects:

```json
{
  "rank": 1,
  "name": "Satanic",
  "team_id": 9824702, // optional
  "team_tag": "PARI", // optional
  "country": "ru" // optional
}
```

- **Current history depth**: ~90 commits spanning Jan 12-16, 2026 (~4 days of data)

---

## Architecture Decision: Build-Time Data Extraction

### Chosen Approach: GitHub Actions Pre-processing + Static Site

**Why this approach:**

1. No backend needed - purely static hosting (GitHub Pages)
2. Git history is the source of truth
3. Build step extracts historical data into a single JSON file
4. Web app loads pre-computed data - fast and simple

### Data Pipeline

```
Git History â†’ GitHub Action (build) â†’ history.json â†’ Static Web App â†’ GitHub Pages
```

**Build process:**

1. A GitHub Action runs on push (or scheduled)
2. Script extracts leaderboard snapshots from git history
3. Outputs `web/data/history.json` with all snapshots
4. Web app is deployed to GitHub Pages

---

## Technical Specifications

### 1. Data Extraction Script

**File**: `scripts/extract-history.js` (Node.js)

**Responsibilities:**

- Read git log to get all commits that modified `leaderboard/europe.json`
- For each commit, extract the file content at that point
- Parse timestamp from commit message or use commit date
- Output a consolidated `history.json`

**Output format** (`web/data/history.json`):

```json
{
  "snapshots": [
    {
      "timestamp": "2026-01-12T12:00:00Z",
      "commitHash": "628e891",
      "players": [
        { "rank": 1, "name": "Satanic", "team_tag": "PARI" },
        ...
      ]
    },
    ...
  ],
  "meta": {
    "generatedAt": "2026-01-16T12:00:00Z",
    "totalSnapshots": 90,
    "dateRange": {
      "from": "2026-01-12T12:00:00Z",
      "to": "2026-01-16T11:31:00Z"
    }
  }
}
```

**Optimization considerations:**

- Limit to last N days (configurable, default 7 days)
- Sample snapshots if too many (e.g., keep 1 per hour if > 168 snapshots)
- Only include fields needed for display (rank, name, team_tag, country)

### 2. GitHub Actions Workflow

**File**: `.github/workflows/build-web.yml`

**Triggers:**

- On push to main (when leaderboard data changes)
- Manual dispatch
- Optionally: scheduled (e.g., daily rebuild)

**Steps:**

1. Checkout with full history (`fetch-depth: 0`)
2. Setup Node.js
3. Run extraction script
4. Build web app (if using a bundler) or just copy files
5. Deploy to GitHub Pages

### 3. Web Application

**Stack**: Vanilla JS + CSS (no framework needed for simplicity)

- Alternative: Could use Vue/React if preferred, but vanilla keeps it simple

**Directory structure:**

```
web/
â”œâ”€â”€ index.html
â”œâ”€â”€ css/
â”‚   â””â”€â”€ styles.css
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ app.js           # Main application logic
â”‚   â”œâ”€â”€ timeline.js      # Timeline component
â”‚   â”œâ”€â”€ leaderboard.js   # Leaderboard display/animation
â”‚   â”œâ”€â”€ player-modal.js  # Player detail view
â”‚   â””â”€â”€ stats.js         # Winners/losers calculation
â”œâ”€â”€ data/
â”‚   â””â”€â”€ history.json     # Generated by build script
â””â”€â”€ assets/
    â””â”€â”€ (any images/icons)
```

---

## Feature Specifications

### Feature 1: Animated Leaderboard with Timeline

**Timeline Component:**

- Horizontal slider at bottom of page
- Shows date/time range from first to last snapshot
- Draggable handle to select point in time
- Play/pause button for auto-play through time
- Speed control (1x, 2x, 5x)
- Tick marks for each day

**Leaderboard Display:**

- Table/list showing top 500 players at selected time
- Columns: Rank, Change indicator (â†‘â†“-), Player Name, Team Tag
- Smooth CSS animations when ranks change:
  - Rows slide up/down to new positions
  - Color flash for rank changes (green up, red down)
- Virtualized list for performance (only render visible rows)

**Animation approach:**

- Use CSS `transform: translateY()` for smooth position changes
- Track each player by name (unique identifier)
- On timeline change, calculate new positions and animate

### Feature 2: Biggest Winners & Losers

**Display location:** Top of page, above leaderboard

**Cards showing:**

- **Top 5 Winners** (biggest rank gains over selected time period)
  - Player name, team tag
  - Rank change: e.g., "ğŸ“ˆ +47 (150 â†’ 103)"
  - Mini sparkline showing their rank over time
- **Top 5 Losers** (biggest rank drops)
  - Same format with "ğŸ“‰ -32 (45 â†’ 77)"

**Time period for calculation:**

- Default: Full available history (first snapshot to current)
- Could add dropdown: "Last 24h", "Last 7 days", "All time"

**Additional interesting stats:**

- **New entries**: Players who appeared in top 500 (weren't there before)
- **Fallen off**: Players who dropped out of top 500
- **Most volatile**: Players with biggest total rank movement (sum of all changes)
- **Most stable**: Top players who barely moved

### Feature 3: Player Detail Modal

**Trigger:** Click on any player row in leaderboard

**Modal contents:**

- Player name, team tag, country flag
- Current rank and best/worst rank in history
- **Rank history chart:**
  - X-axis: Time (all snapshots)
  - Y-axis: Rank (inverted, 1 at top)
  - Line chart showing rank over time
  - Hover for exact values
- Stats summary:
  - Total rank change from first to last snapshot
  - Average rank
  - Time at current rank
  - Biggest single jump (up or down)

**Chart library:** Chart.js (lightweight, no dependencies)

---

## UI/UX Design Notes

### Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ† Dota 2 Leaderboard Time Machine                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“ˆ Winners   â”‚  â”‚ ğŸ“‰ Losers    â”‚  â”‚ ğŸ“Š Stats     â”‚   â”‚
â”‚  â”‚ 1. Player +X â”‚  â”‚ 1. Player -X â”‚  â”‚ New: 12      â”‚   â”‚
â”‚  â”‚ 2. ...       â”‚  â”‚ 2. ...       â”‚  â”‚ Dropped: 8   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Showing: Jan 16, 2026 11:31 UTC                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ Rank â”‚ Î”  â”‚ Player        â”‚ Team    â”‚                â”‚
â”‚  â”‚ 1    â”‚ -  â”‚ Satanic       â”‚ PARI    â”‚                â”‚
â”‚  â”‚ 2    â”‚ â†‘3 â”‚ Nightfall     â”‚ Aurora  â”‚                â”‚
â”‚  â”‚ 3    â”‚ â†“1 â”‚ Malr1ne       â”‚ FLCN    â”‚                â”‚
â”‚  â”‚ ...  â”‚    â”‚               â”‚         â”‚                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â—€ â–¶ â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1x 2x 5x        â”‚
â”‚  Jan 12         Jan 14         Jan 16                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Color Scheme

- Dark theme (easier on eyes, gaming aesthetic)
- Background: `#1a1a2e`
- Cards: `#16213e`
- Accent: `#e94560` (Dota red-ish)
- Positive: `#00ff88`
- Negative: `#ff4757`
- Text: `#eaeaea`

### Responsive Design

- Desktop-first (leaderboards are data-heavy)
- Mobile: Stack cards vertically, horizontal scroll for table

---

## Implementation Phases

### Phase 1: Data Pipeline (Priority: Critical)

1. Create `scripts/extract-history.js`
2. Create `.github/workflows/build-web.yml`
3. Test locally, verify `history.json` generation

### Phase 2: Basic Web App (Priority: High)

1. Create `web/index.html` with basic structure
2. Create `web/js/app.js` - load and parse history.json
3. Create `web/js/leaderboard.js` - render leaderboard table
4. Create `web/css/styles.css` - basic dark theme styling

### Phase 3: Timeline Feature (Priority: High)

1. Create `web/js/timeline.js` - timeline slider component
2. Wire timeline to leaderboard display
3. Add play/pause/speed controls
4. Implement smooth animations for rank changes

### Phase 4: Winners/Losers (Priority: Medium)

1. Create `web/js/stats.js` - calculate rankings changes
2. Add winner/loser cards to UI
3. Add time period selector

### Phase 5: Player Modal (Priority: Medium)

1. Create `web/js/player-modal.js`
2. Add Chart.js for rank history visualization
3. Style modal and chart

### Phase 6: Polish (Priority: Low)

1. Add loading states
2. Add error handling
3. Performance optimization (virtualization if needed)
4. Mobile responsive tweaks
5. Add favicon, meta tags, Open Graph

---

## File Checklist (to be created)

- [x] `scripts/extract-history.js` - Git history extraction script
- [x] `scripts/package.json` - Dependencies for extraction script
- [x] `.github/workflows/build-web.yml` - Build and deploy workflow
- [x] `web/index.html` - Main HTML page
- [x] `web/css/styles.css` - Styles
- [x] `web/js/app.js` - Main app entry point
- [x] `web/js/timeline.js` - Timeline component
- [x] `web/js/leaderboard.js` - Leaderboard rendering
- [x] `web/js/player-modal.js` - Player detail modal
- [x] `web/js/stats.js` - Statistics calculations
- [x] `web/data/.gitkeep` - Placeholder (history.json is generated)

---

## Configuration Options

In `scripts/extract-history.js` or via environment variables:

```javascript
const CONFIG = {
  MAX_DAYS: 7, // How many days of history to include
  MAX_SNAPSHOTS: 168, // Maximum snapshots (7 days * 24 hours)
  SAMPLE_INTERVAL: 1, // Keep every Nth snapshot if over max
  OUTPUT_PATH: "web/data/history.json",
};
```

---

## Deployment

### GitHub Pages Setup

1. Enable GitHub Pages in repo settings
2. Source: GitHub Actions
3. The build workflow will handle deployment

### Alternative: Netlify/Vercel

- Connect repo
- Build command: `node scripts/extract-history.js`
- Publish directory: `web/`

---

## Open Questions / Future Enhancements

1. **Multiple regions?** Currently Europe only - could add other regions
2. **Search/filter?** Allow searching for specific players
3. **Permalink/sharing?** URL params for specific time or player
4. **Notifications?** Alert when specific player moves significantly
5. **Data size?** If history grows too large, implement pagination or lazy loading

---

## Notes for Implementation

- Use `git show <commit>:leaderboard/europe.json` to get file at specific commit
- Parse commit message for timestamp, fallback to commit date
- Player identity is by `name` field (assumed unique enough)
- Consider players dropping in/out of top 500 in calculations
- CSS `will-change: transform` for smooth animations
- Use `requestAnimationFrame` for timeline scrubbing performance
